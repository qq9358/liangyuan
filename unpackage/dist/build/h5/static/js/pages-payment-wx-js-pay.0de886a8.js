(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-payment-wx-js-pay"],{"00dd":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'.tui-modal-box[data-v-4d779772]{position:fixed;left:50%;top:50%;margin:auto;background-color:#fff;z-index:9999998;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;box-sizing:border-box;visibility:hidden}.tui-modal-scale[data-v-4d779772]{-webkit-transform:translate(-50%,-50%) scale(0);transform:translate(-50%,-50%) scale(0)}.tui-modal-normal[data-v-4d779772]{-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}.tui-modal-show[data-v-4d779772]{opacity:1;visibility:visible}.tui-modal-mask[data-v-4d779772]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.6);z-index:9999996;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;visibility:hidden}.tui-mask-show[data-v-4d779772]{visibility:visible;opacity:1}.tui-modal-title[data-v-4d779772]{text-align:center;font-size:%?34?%;color:#333;padding-top:%?20?%;font-weight:700}.tui-modal-content[data-v-4d779772]{text-align:center;color:#999;font-size:%?28?%;padding-top:%?20?%;padding-bottom:%?60?%}.tui-mtop[data-v-4d779772]{margin-top:%?30?%}.tui-mbtm[data-v-4d779772]{margin-bottom:%?30?%}.tui-modalBtn-box[data-v-4d779772]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.tui-flex-column[data-v-4d779772]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.tui-modal-btn[data-v-4d779772]{width:46%;height:%?68?%;line-height:%?68?%;position:relative;border-radius:%?10?%;font-size:%?26?%;overflow:visible;margin-left:0;margin-right:0;padding:0 0}.tui-modal-btn[data-v-4d779772]::after{content:" ";position:absolute;width:200%;height:200%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(.5);transform:scale(.5);left:0;top:0;border-radius:%?20?%}.tui-btn-width[data-v-4d779772]{width:80%!important}.tui-primary[data-v-4d779772]{background:#5677fc;color:#fff}.tui-primary-hover[data-v-4d779772]{background:#4a67d6;color:#e5e5e5}.tui-primary-outline[data-v-4d779772]{color:#5677fc;background:transparent}.tui-primary-outline[data-v-4d779772]::after{border:1px solid #5677fc}.tui-danger[data-v-4d779772]{background:#ed3f14;color:#fff}.tui-danger-hover[data-v-4d779772]{background:#d53912;color:#e5e5e5}.tui-danger-outline[data-v-4d779772]{color:#ed3f14;background:transparent}.tui-danger-outline[data-v-4d779772]::after{border:1px solid #ed3f14}.tui-red[data-v-4d779772]{background:#e41f19;color:#fff}.tui-red-hover[data-v-4d779772]{background:#c51a15;color:#e5e5e5}.tui-red-outline[data-v-4d779772]{color:#e41f19;background:transparent}.tui-red-outline[data-v-4d779772]::after{border:1px solid #e41f19}.tui-warning[data-v-4d779772]{background:#ff7900;color:#fff}.tui-warning-hover[data-v-4d779772]{background:#e56d00;color:#e5e5e5}.tui-warning-outline[data-v-4d779772]{color:#ff7900;background:transparent}.tui-warning-outline[data-v-4d779772]::after{border:1px solid #ff7900}.tui-green[data-v-4d779772]{background:#19be6b;color:#fff}.tui-green-hover[data-v-4d779772]{background:#16ab60;color:#e5e5e5}.tui-green-outline[data-v-4d779772]{color:#19be6b;background:transparent}.tui-green-outline[data-v-4d779772]::after{border:1px solid #19be6b}.tui-white[data-v-4d779772]{background:#fff;color:#333}.tui-white-hover[data-v-4d779772]{background:#f7f7f9;color:#666}.tui-white-outline[data-v-4d779772]{color:#333;background:transparent}.tui-white-outline[data-v-4d779772]::after{border:1px solid #333}.tui-gray[data-v-4d779772]{background:#ededed;color:#999}.tui-gray-hover[data-v-4d779772]{background:#d5d5d5;color:#898989}.tui-gray-outline[data-v-4d779772]{color:#999;background:transparent}.tui-gray-outline[data-v-4d779772]::after{border:1px solid #999}.tui-outline-hover[data-v-4d779772]{opacity:.6}.tui-circle-btn[data-v-4d779772]{border-radius:%?40?%!important}.tui-circle-btn[data-v-4d779772]::after{border-radius:%?80?%!important}',""]),t.exports=e},"090a":function(t,e,n){"use strict";var a,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e)}}},[n("v-uni-view",{staticClass:"tui-modal-box",class:[t.fadeIn||t.show?"tui-modal-normal":"tui-modal-scale",t.show?"tui-modal-show":""],style:{width:t.width,padding:t.padding,borderRadius:t.radius}},[t.custom?n("v-uni-view",[t._t("default")],2):n("v-uni-view",[t.title?n("v-uni-view",{staticClass:"tui-modal-title"},[t._v(t._s(t.title))]):t._e(),n("v-uni-view",{staticClass:"tui-modal-content",class:[t.title?"":"tui-mtop"],style:{color:t.color,fontSize:t.size+"rpx"}},[t._v(t._s(t.content))]),n("v-uni-view",{staticClass:"tui-modalBtn-box",class:[2!=t.button.length?"tui-flex-column":""]},[t._l(t.button,(function(e,a){return[n("v-uni-button",{key:a+"_0",staticClass:"tui-modal-btn",class:["tui-"+(e.type||"primary")+(e.plain?"-outline":""),2!=t.button.length?"tui-btn-width":"",t.button.length>2?"tui-mbtm":"","circle"==t.shape?"tui-circle-btn":""],attrs:{"hover-class":"tui-"+(e.plain?"outline":e.type||"primary")+"-hover","data-index":a},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick.apply(void 0,arguments)}}},[t._v(t._s(e.text||"确定"))])]}))],2)],1)],1),n("v-uni-view",{staticClass:"tui-modal-mask",class:[t.show?"tui-mask-show":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClickCancel.apply(void 0,arguments)}}})],1)},i=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},"121b":function(t,e,n){"use strict";var a=n("ee27");n("ac1f"),n("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var r=a(n("c964")),i=a(n("a70c")),o=a(n("caf4")),u=a(n("4a8c")),d=a(n("1b0f")),c=(a(n("ed00")),{data:function(){return{countdownText:"",totalMoney:0,timer:-1,queryTimer:-1,saving:!1,shouldConfirm:!0,listNo:"",modal:!1}},computed:{product:function(){return uni.getStorageSync("Pay:Product")}},onLoad:function(t){var e=this;return(0,r.default)(regeneratorRuntime.mark((function n(){var a,r,u,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.listNo=t.listNo,n.next=4,o.default.getNetPayOrderAsync(e.listNo);case 4:if(a=n.sent,e.totalMoney=a.payMoney,!(a.expireSeconds<=0)){n.next=11;break}return e.shouldConfirm=!1,e.$router.push({name:"tickettype"}),uni.showTabBar({url:"/pages/index/index"}),n.abrupt("return");case 11:r=(0,i.default)("2018-01-01 00:00:00"),u=r.clone().addSeconds(a.expireSeconds),d=a.expireSeconds>3600?"HH:mm:ss":"mm:ss",e.countdownText=u.format(d),e.timer=setInterval((function(){u=u.addSeconds(-1),e.countdownText=u.format(d),u.isSame(r)&&o.default.getNetPayOrderAsync(e.listNo).then((function(t){e.clear(),e.shouldConfirm=!1,t.paySuccess?uni.redirectTo({url:"/pages/order/order-detail?listNo="+e.listNo}):e.$dialog.alert({title:"支付超时订单已取消"}).then((function(){uni.redirectTo({url:"/pages/index/index"})}))}))}),1e3),n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](0),console.log(n.t0);case 21:case"end":return n.stop()}}),n,null,[[0,18]])})))()},beforeRouteLeave:function(t,e,n){if(!this.shouldConfirm||t.meta.shouldNotConfirm)return this.clear(),void n();this.modal=!0,n(!1)},methods:{pay:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.saving=!0,e.next=4,o.default.jsApiPayAsync(t.listNo);case 4:return n=e.sent,e.next=7,d.default.jsApiPay(n);case 7:console.log(n),uni.showLoading({title:"查询支付结果..."}),t.queryTimer=setInterval((function(){o.default.getNetPayOrderAsync(t.listNo).then((function(e){e.paySuccess&&(t.clear(),t.shouldConfirm=!1,t.$router.replace({name:"orderdetail",params:{listNo:t.listNo}}))}))}),3e3),e.next=17;break;case 12:if(e.prev=12,e.t0=e["catch"](0),"get_brand_wcpay_request:cancel"!=e.t0.err_msg){e.next=16;break}return e.abrupt("return");case 16:u.default.logError(e.t0);case 17:return e.prev=17,t.saving=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,12,17,20]])})))()},clear:function(){clearInterval(this.timer),clearInterval(this.queryTimer)},handleClick:function(t){var e=t.index;0===e||(this.clear(),this.shouldConfirm=!1,uni.navigateTo({url:"/pages/order/order-detail?listNo=".concat(this.listNo)})),this.hide()},hide:function(){this.modal=!1}}});e.default=c},"1aba":function(t,e,n){var a=n("00dd");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var r=n("4f06").default;r("03206fe8",a,!0,{sourceMap:!1,shadowMode:!1})},"49ef":function(t,e,n){"use strict";var a=n("cad6"),r=n.n(a);r.a},"4a8c":function(t,e,n){"use strict";var a=n("ee27");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var r=a(n("c964")),i=a(n("814b")),o={logError:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return"object"==typeof t&&(t=JSON.stringify(t)),e.next=3,i.default.post("/common/LogError?message=".concat(t));case 3:case"end":return e.stop()}}),e)})))()},getEducationComboboxItems:function(){return(0,r.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.get("/common/GetEducationComboboxItems");case 2:return e=t.sent,t.abrupt("return",e.result);case 4:case"end":return t.stop()}}),t)})))()},getNationComboboxItems:function(){return(0,r.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.get("/common/GetNationComboboxItems");case 2:return e=t.sent,t.abrupt("return",e.result);case 4:case"end":return t.stop()}}),t)})))()},getAgeRangeComboboxItemsAsync:function(){return(0,r.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.get("/common/GetAgeRangeComboboxItemsAsync");case 2:return e=t.sent,t.abrupt("return",e.result);case 4:case"end":return t.stop()}}),t)})))()},getTouristOriginTreeAsync:function(){return(0,r.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.get("/common/GetTouristOriginTreeAsync");case 2:return e=t.sent,t.abrupt("return",e.result);case 4:case"end":return t.stop()}}),t)})))()},sendVerificationCodeAsync:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.post("/common/SendVerificationCodeAsync?address=".concat(t));case 2:case"end":return e.stop()}}),e)})))()}};e.default=o},"4bbf":function(t,e,n){"use strict";n.r(e);var a=n("815c"),r=n("e065");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("49ef");var o,u=n("f0c5"),d=Object(u["a"])(r["default"],a["b"],a["c"],!1,null,"73bec646",null,!1,a["a"],o);e["default"]=d.exports},"603f":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * scss预处理 内置的常用样式变量\r\n * 后期项目会考虑使用scss\r\n*/\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.in-order[data-v-73bec646]{background-color:#fff;text-align:center;padding:15px 15px}.in-order-countdown[data-v-73bec646]{font-size:13px;color:#999;line-height:1}.in-order-fee[data-v-73bec646]{margin-top:10px;line-height:1;font-size:30px;letter-spacing:-.44px}.in-order-fee-text[data-v-73bec646]{font-size:20px;margin-right:8px}.in-order-fee uni-text[data-v-73bec646]{font-weight:700}.in-order-title[data-v-73bec646]{margin-top:3px;font-size:11px;color:#999}.in-pay-method[data-v-73bec646]{margin:15px 0;background-color:#fff}.in-pay-method-pay-type[data-v-73bec646]{padding:0 20px;height:70px;line-height:70px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.in-pay-method-pay-type uni-view[data-v-73bec646]{vertical-align:middle;font-size:25px;margin-right:20px;color:#09bb07}.in-pay-method-pay-type uni-text[data-v-73bec646]{display:inline-block;vertical-align:middle;font-size:18px;font-weight:600}.in-button[data-v-73bec646]{padding:0 15px}.in-button uni-button[data-v-73bec646]{border-radius:5px;height:50px;line-height:39px;font-size:16px;background:#19a0f0}',""]),t.exports=e},"6d7c":function(t,e,n){"use strict";n.r(e);var a=n("cb15"),r=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=r.a},"815c":function(t,e,n){"use strict";var a={tuiModal:n("a273").default},r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"in-order"},[n("v-uni-view",{staticClass:"in-order-countdown"},[t._v("支付剩余时间"),n("v-uni-text",[t._v(t._s(t.countdownText))])],1),n("v-uni-view",{staticClass:"in-order-fee"},[n("v-uni-text",{staticClass:"in-order-fee-text"},[t._v("¥")]),n("v-uni-text",[t._v(t._s(t.totalMoney))])],1),n("v-uni-view",{staticClass:"in-order-title"},[t._v(t._s(t.product))])],1),n("v-uni-view",{staticClass:"in-pay-method"},[n("v-uni-view",{staticClass:"in-pay-method-pay-type"},[n("v-uni-view",{staticClass:"iconfont icon-weixin"}),n("v-uni-text",[t._v("微信支付")])],1)],1),n("v-uni-view",{staticClass:"in-button"},[n("v-uni-button",{attrs:{type:"primary",size:"large",loading:t.saving},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.pay.apply(void 0,arguments)}}},[t._v("确认支付")])],1),n("tui-modal",{attrs:{show:t.modal,title:"提示",content:"你的支付尚未完成，是否取消支付？"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick.apply(void 0,arguments)},cancel:function(e){arguments[0]=e=t.$handleEvent(e),t.hide.apply(void 0,arguments)}}})],1)},i=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},a273:function(t,e,n){"use strict";n.r(e);var a=n("090a"),r=n("6d7c");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("ad4b");var o,u=n("f0c5"),d=Object(u["a"])(r["default"],a["b"],a["c"],!1,null,"4d779772",null,!1,a["a"],o);e["default"]=d.exports},ad4b:function(t,e,n){"use strict";var a=n("1aba"),r=n.n(a);r.a},cad6:function(t,e,n){var a=n("603f");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var r=n("4f06").default;r("374952f0",a,!0,{sourceMap:!1,shadowMode:!1})},caf4:function(t,e,n){"use strict";var a=n("ee27");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var r=a(n("c964")),i=a(n("814b")),o={getNetPayOrderAsync:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.get("/payment/GetNetPayOrderAsync?listNo=".concat(t));case 2:return n=e.sent,e.abrupt("return",n.result);case 4:case"end":return e.stop()}}),e)})))()},jsApiPayAsync:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.post("/payment/JsApiPayAsync?listNo=".concat(t));case 2:return n=e.sent,e.abrupt("return",n.result);case 4:case"end":return e.stop()}}),e)})))()},miniProgramPayAsync:function(t){return(0,r.default)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.post("/payment/MiniprogramPayAsync?listNo=".concat(t));case 2:return n=e.sent,e.abrupt("return",n.result);case 4:case"end":return e.stop()}}),e)})))()}};e.default=o},cb15:function(t,e,n){"use strict";n("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"tuiModal",props:{show:{type:Boolean,default:!1},width:{type:String,default:"84%"},padding:{type:String,default:"40rpx 64rpx"},radius:{type:String,default:"24rpx"},title:{type:String,default:""},content:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},shape:{type:String,default:"square"},button:{type:Array,default:function(){return[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red",plain:!1}]}},maskClosable:{type:Boolean,default:!0},fadeIn:{type:Boolean,default:!1},custom:{type:Boolean,default:!1}},data:function(){return{}},methods:{handleClick:function(t){if(this.show){var e=t.currentTarget.dataset;this.$emit("click",{index:Number(e.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")}}};e.default=a},e065:function(t,e,n){"use strict";n.r(e);var a=n("121b"),r=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=r.a},ed00:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={noneToast:function(t){uni.showToast({title:t,icon:"none"})}};e.default=a}}]);